| **Command** | **Description** |
| --------------|-------------------|
| `xfreerdp /v:<target IP address> /u:htb-student /p:<password>` | RDP to lab target |
|Â `Get-WmiObject -Class win32_OperatingSystem` | Get information about the operating system |
| `dir c:\ /a` | View all files and directories in the c:\ root directory |
| `tree <directory>` | Graphically displaying the directory structure of a path |
| `tree c:\ /f \| more` | Walk through results of the `tree` command page by page |
| `icacls <directory>` | View the permissions set on a directory |
| `icacls c:\users /grant joe:f` | Grant a user full permissions to a directory |
| `icacls c:\users /remove joe` | Remove a users' permissions on a directory |
| `Get-Service` | `PowerShell` cmdlet to view running services |
| `help <command>` | Display the help menu for a specific command |
| `get-alias` | List `PowerShell` aliases |
| `New-Alias -Name "Show-Files" Get-ChildItem` | Create a new `PowerShell` alias |
| `Get-Module \| select Name,ExportedCommands \| fl` | View imported `PowerShell` modules and their associated commands |
| `Get-ExecutionPolicy -List` | View the `PowerShell` execution policy |
| `Set-ExecutionPolicy Bypass -Scope Process` | Set the `PowerShell` execution policy to bypass for the current session |
| `wmic os list brief` | Get information about the operating system with `wmic` |
| `Invoke-WmiMethod` | Call methods of `WMI` objects |
| `whoami /user` | View the current users' SID |
| `reg query <key>` | View information about a registry key |
| `Get-MpComputerStatus` | Check which `Defender` protection settings are enabled |
| `sconfig` | Load Server Configuration menu in Windows Server Core |

Open cmd with administrator privilege:

- Mod+r , write cmd and open with ctrl+shift+enter and then open a UAC popup
- powershell -Command "Start-Process cmd -Verb RunAs"

reset password to next logon:
wmic is deprecated in w10 21H1
```
net user Jim asd /add; 
wmic UserAccount where Name='Jim' set PasswordExpires=true;
net user "Jim" /logonpasswordchg:yes
```
```powershell

```
cmd: `wmic UserAccount where name='Jim' set PasswordExpires=true`

Followed by

cmd: `net user "John Doe" /logonpasswordchg:yes` (only double quote)

`netplwiz` : User Accounts

`shell:startup`: `C:\Users\htb-student\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`


Conocer SID de un grupo
`(Get-Localgroup $GroupName).SID`

`Get-WMIObject win32_group -filter "name='NameOfGroup'"|select Name,sid`

