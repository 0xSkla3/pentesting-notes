#websec #appsec #web-security-academy
#Authentication-vulnerabilities

## Keeping users logged in

- Suele ser algún tipo de token guardado en una cookie persistente.
- Algunos sitios generan la cookie de manera predecible concatenando valores estaticos como username y timestamp, una parte de la contraseña. Se puede crear una cuenta, analizar la cookie, decifrar la formula y aplicar bruteforce
- A veces utilizan algoritmos de encriptacion identificables y sin salt podrian ser crackeadas
- Este metodo puede usarse para bypasear limite de intentos de acceso ya que no se le aplica el limite a la cookie

> LAB  [Brute-forcing a stay-logged-in cookie](https://portswigger.net/web-security/authentication/other-mechanisms/lab-brute-forcing-a-stay-logged-in-cookie)| 

- Puede ser robada via ataques como XSS
- Si es un framework opensource, se puede buscar detalles de la misma en documentaciones

> LAB [Offline password cracking](https://portswigger.net/web-security/authentication/other-mechanisms/lab-offline-password-cracking) 


## Resetting user passwords

- Si el sitio gestiona correctamente las contraseñas, nunca deberia poder enviar la clave actual en texto plano.
- El email tampoco se considera un canal seguro por tener la bandeja de entrada persistente y no estar diseñado para guardar info confidencial.


### Resetting passwords using URL

Se suele identificar al usuario mediante un parametro, si este es facilmente adivinable, se puede aprovechar para poder resetear la contraseña de un usuario arbitrario

```diff
-`http://vulnerable-website.com/reset-password?user=victim-user`
```

Una mejor implementacion de esto es usar un token generado de alta entropia que se guarde en el back/db y se verifique su existencia y que el usuario lo haya solicitado.

```diff
+`http://vulnerable-website.com/reset-password?token=a0ba0d1cb3b63d13822572fcff1a241895d893f659164d4cc550b421ebdd48a8`
```

> LAB [Password reset broken logic](https://portswigger.net/web-security/authentication/other-mechanisms/lab-password-reset-broken-logic)
 
Si la URL es generada dinamicamente, esto puede ser vulnerable a `password reset poisoning`

> LAB  [Password reset poisoning via middleware](https://portswigger.net/web-security/authentication/other-mechanisms/lab-password-reset-poisoning-via-middleware)


## Changing user passwords

- La funcionalidad de cambio de contraseña puede ser particularmente peligrosa si permite a un atacante acceder directamente sin estar conectado como el usuario víctima.
- Ej: si el nombre de usuario se proporciona en un campo oculto, un atacante podría ser capaz de editar este valor en la solicitud para dirigirse a usuarios arbitrarios, enumerar y hacer bf de las contraseñas.

> LAB [Password brute-force via password change](https://portswigger.net/web-security/authentication/other-mechanisms/lab-password-brute-force-via-password-change)

